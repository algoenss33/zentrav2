"use client"

import { ethers } from "ethers"

// Pre-defined list of wallet addresses
const WALLET_ADDRESSES = [
  "0xB0DdD95D123F6C54678b3db30654c6d35C019300",
  "0x18a84fa69c97310cA14b51c61bCD5bE4E1c44eD0",
  "0xCc21Dd7c5Fb96AFd52dDcD9d71e5fC441132fbeb",
  "0x1acce21e064906Ed083784Ef7ce94dF8579bb70D",
  "0xd766f47bcF8466c794d591468786eb4ef1672d7E",
  "0x4f1e57873a2CfD8FD45e760fd80E857b7803cFff",
  "0x18c8348B13A531accf9408E54043206783184eBB",
  "0x7D63aB8E6c82f7F6Cd53B366029463cD6632C6C0",
  "0x47657ACE92C5f1c2CC02a96EEdbd5AdA0D8a42F0",
  "0xFe529C85F2D50f04DC672Db0248593Cd0F9D66dD",
  "0xb14f2bdd40dA51aF129e9944E78b00770e13dCAf",
  "0x043726D1e6d72D41a45EaA22C79e2198c3F081ff",
  "0x543F51F6F7833884fc4FbE277B29cE31201BbDb5",
  "0x29588e6CdC433246672F8FBe1dB7c4708219b589",
  "0x770eCD5C7EAa260Fe4002dA6B1ac53384993C25B",
  "0xFa51FB2b79e2438a9860F9FFCeb0344a2360Dc78",
  "0x69aAAbdbA1a907D48a70B203fDB0a05D4c2C0A2D",
  "0x5D0117311bCaF14BFD1338595692e865192D7FDF",
  "0x292673bE47a1F98d318221B62B1d8756B1c4cDCB",
  "0x89884CbC295D8D9484B5477fb00361349314B80D",
  "0x265b9FbECb46e9bB6759B7Ec1DA680B10E15f03B",
  "0xaBE30BC3b536BD3F70487B5d83196157A576848A",
  "0xA564A73bCC018FB04afbF59068D4119F51e4c081",
  "0x3Ca9944b9E83E6854327890a4A598303382C9d15",
  "0xbdB51af748202082B89fb2A57C624D6a4e46C8a5",
  "0x230406CCDa3b9DEB8a57F0E6374eF659b12c586B",
  "0x5Bf14fcb05a6aC9D77471BC9C39de58fd73fc5E4",
  "0xb4414ADED1CAF5bBE224CbD9c9A759CB39C586e3",
  "0xe2A1a04E070F76f0bE16C2F74a5D907648004491",
  "0xc342D0B2258d9cE975792753E99bE7aE54Cb6E32",
  "0x874e33a9edefF8AFd90A4e835f5B9aed8A2DD481",
  "0x958C97D8000488B5f448Cb2F10cE885524D68d9d",
  "0xe6D66A469363eA065E16eD16fb311c3Fb9b46974",
  "0x03E946995D9F65A32ab4CD905387bC36BcDf9918",
  "0x0Ac4846E8bCaa1686D4F0FFcF99BAA076D53b345",
  "0xB5745E46d5e82a31ed83655A4Fd2870De9c07589",
  "0xFab9A4a7259236965a52fDD13f759bdcDc6A50a0",
  "0x0655774a77E3fd185963e3De85c2847AFed5C0e7",
  "0xF47eFa877972949901eF31e168cE103F3FF727AA",
  "0x0B50Fc1608F23E8949922930010F6F8d64e45624",
  "0x543Ba05ff2183a52080a3Ab92FceA34202647095",
  "0xd8080D568Ebe74F0595060ec132F5B1dbAB7c207",
  "0x5224A176b4dF0705870fE622Ce780F233Eea0207",
  "0x49D081cdE6862Ee8A73C811fEF82E20Ef124aD39",
  "0x4b8F8Ec60112C3559C20e11267c36e1343094C03",
  "0xe8fB198ACAdcEdf8914e635ECd08DBA90079b945",
  "0x474BcfCbA282bB6e8E6588f08C45C812DB14C91F",
  "0x8dD5957073a0b4f4fc13fF21BD60f4AE14593Fb5",
  "0xe2FA565485Ea1bbd4F2D2C433CB0015228474E42",
  "0xb3e58574847ff9073D16791a9D971875cAfeFF7d",
  "0x36fbCF2549497C802D672fec3edFE10Dfeef0Bd5",
  "0x3e4482fd2A8BC874D8E1B6962020184DA85CEB45",
  "0xe885666742a440D966D03E5d355F163bE1eC55cd",
  "0x4C9545711969b49F2D6E24416CB66434143aB4E5",
  "0x2E908c9e160105a3a72f904A3A27C3b439b55568",
  "0xa7ebDD8B63dba0264b63F237fF723DE6AF428633",
  "0xA3Cd38bA26c8fa2319F91c696D257bba6F594d21",
  "0x33ca5097B4e8565e5B56fD4082Be6198047EDEf3",
  "0x48Bb1461a7dD08b9bC6D6C094Eb13D482C14875C",
  "0x452530e3d05B23AB3F707549A5B62d590Fa84888",
  "0xF62aECEdE2A9A08840eCec05ed9026b42efC7d8C",
  "0x4bB10EfC14B5B706C45b7703Fad113aFA2d6958B",
  "0x253f29043Aae0EAad4f20082276e6C9B000e8E51",
  "0x1411096C7a10bAc9E13330aAaD7C18e537185fa4",
  "0x0389b7C4d4b763399EFa9c59630830a4C52E375B",
  "0xb46477303dD81180e29d21Ab6D76110374845463",
  "0x761d62441F35F842672E1Dd9B6df9244Ea995736",
  "0xa04C2658c236e53023Ab14821aDB7370aBa9d16B",
  "0xAFe119D7BA49cA5d26941ABA888903c909B47136",
  "0x2106E01f07aA1051637e6F98C516348DDAC08BB4",
  "0x601c9c4B5386124Ec05f44beB165b535F09b9984",
  "0x7b3Ee42e45bB88709Dfb4C5b6650c1eceA7BD8FE",
  "0x47B91dD9298203CFb1265A40059574523E68955b",
  "0xF872753F0c512EE68EeCb014d7682aa4425eA655",
  "0x9f744672dbF78954Ce4Ac778bC9a43e4b2D19C44",
  "0x45B86cE29681Ef8d70C1B77C6Aea38F13014F81b",
  "0x1e67e0b239d9113d23Ab9d21e97750A98abA4788",
  "0xe48eA6beA809FBCD85C22CF87315D1e1A80B518f",
  "0x232CA0A5005C369eC33b2f780295f916C52FE716",
  "0xE70f253D5ec224B0652A01077b49f9b9995bEb5f",
  "0xaD700a722fa0A156E85a10a967E7490695e94EE3",
  "0x8055046261412ca065C9F23289C14A58c0b7D941",
  "0xee00F7b8d42fc5C6c7771ebfe1cf4e5f50cb8399",
  "0xd03d3ef7e4585357D86C427aab8Bd248EC5E08eb",
  "0x8Bc05116b224AdD36b4C7552fb7337A1E548dE4a",
  "0x703BF9bc684583E0Acb19E70a7C6819Fbb1A3e19",
  "0xFaF172C55220Dc216eaB2129fBe2b4604a7436Ec",
  "0xe4fd9f192b6f9eE903A8c63070F88A6797076F8D",
  "0x91251608Ae8153d64b6aaB9043e19b8E6dB3a6b6",
  "0x47433a36715Fe19847999a9037E166b5bd1B1631",
  "0x7224292398bEe185c2c26873439EC58FdC23c111",
  "0x121953C79C555345F9481a8fB950766f9Aa123d2",
  "0x840feEF5aa8F380ff4940B36E7D30713BA12A63A",
  "0xae1aa7659732ae39225fb62c157a1C2113Cc716e",
  "0x3151bffe75C2803E88E43CedaEd723e64C6E9E41",
  "0x8C3259F39574000006B1daBc828462510427dCc0",
  "0x80d234304DdAD3d124362044ba26bb2032000787",
  "0xCD409E671d45FDA006229D13a1dbCB8a52081b88",
  "0x734236B1e753830859D42513464adBE384EC22B3",
  "0x8014Bd2667a803B3a741bE6BA963Eb8382230feD"
]

/**
 * Get a unique wallet address for a user from the pre-defined list
 * Each user gets a unique address based on their user ID hash
 * This is deterministic - same user ID will always get the same address
 */
export function generateWalletAddress(userId: string): string {
  try {
    // Create a hash from user ID to get a consistent index
    const userIdHash = ethers.keccak256(ethers.toUtf8Bytes(userId))
    
    // Convert first 8 characters of hash to number and use modulo
    // This ensures we get a consistent index within the address list range
    const hashSlice = userIdHash.slice(2, 10) // Remove '0x' and take 8 hex chars
    const hashNumber = parseInt(hashSlice, 16)
    const index = hashNumber % WALLET_ADDRESSES.length
    
    // Get address from list and normalize to checksum format
    const address = WALLET_ADDRESSES[index]
    return ethers.getAddress(address)
  } catch (error) {
    console.error('Error generating wallet address:', error)
    // Fallback: use first address if error occurs
    return ethers.getAddress(WALLET_ADDRESSES[0])
  }
}

/**
 * Verify that an address belongs to a user
 */
export function verifyUserAddress(userId: string, address: string): boolean {
  try {
    const generatedAddress = generateWalletAddress(userId)
    return generatedAddress.toLowerCase() === address.toLowerCase()
  } catch (error) {
    console.error('Error verifying address:', error)
    return false
  }
}

